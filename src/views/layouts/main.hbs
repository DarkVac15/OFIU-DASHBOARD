<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OFIU</title>
    <link rel="icon" href="/img/icon.ico" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400,300' rel='stylesheet' type='text/css'>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3"></script>
    <!-- Enlazar Leaflet.js y Leaflet.heat -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-image/0.1.0/leaflet-image.min.js"></script>
</head>

<body class="{{bodyClass}} bg-dark text-light bg-light text-dark">
    <!-- Mostrar alerta si hay un mensaje -->
  
    {{#if showNavbar}}
    {{> navbar}} <!-- Mostrar el navbar solo si showNavbar es true -->
    {{/if}}


    <!-- Aquí va el script de Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-auth.js";
        import { getStorage } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-storage.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDjA8ZMhvprgLTJelQtrFYceAKMD6dh9DM",
            authDomain: "ofiuremake.firebaseapp.com",
            projectId: "ofiuremake",
            storageBucket: "ofiuremake.appspot.com",
            messagingSenderId: "1071493213460",
            appId: "1:1071493213460:web:2fd2032a757357283c6601",
        };

        const app = initializeApp(firebaseConfig);
        const storage = getStorage(app);
        const auth = getAuth(app);

        // Exponer el storage y auth globalmente
        window.firebaseStorage = storage;
        window.firebaseAuth = auth;

        async function logout() {
            try {
                await signOut(auth);
                console.log('Usuario ha cerrado sesión');
                await fetch('/logout', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });

                window.location.href = '/administracion';
            } catch (error) {
                console.error('Error al cerrar sesión:', error);
            }
        }

        document.getElementById('logoutButton')?.addEventListener('click', logout);
    </script>

    {{{body}}}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


</body>

</html>